<link rel="import" href="../polymer/polymer.html" />
<link rel="import" href="../px-theme/px-theme.html">
<link rel="import" href="../px-theme/px-app.html">
<link rel="import" href="../px-partials/px-partials.html">
<link rel="import" href="../px-navbar/px-navbar.html">
<link rel="import" href="../px-drawer/px-drawer.html">
<link rel="import" href="px-media-query.html">


<!--
## Overview
The px-layout element aims to help developers create responsive layouts.

The layout types are:

1. offcanvas
2. full
3. progressive
4. splitview


## Usage

```
Code Here
```
@element px-layout
@demo demo.html
@homepage index.html
-->
<dom-module id="px-layout">

  <link rel="stylesheet" href="../px-mobile-design/css/px-mobile-design.css">
  <link rel="stylesheet" href="css/px-responsive-layouts-sketch.css">
  <template strip-whitespace>
    <style>

      html, body{
        margin: 0 !important;
        width: 100%;
        height: 100%;
        overflow: hidden !important;
      }

      :host {
        display: block;
        position: relative;
        overflow: hidden;
        height: 100%;
      }

      :host .scrollable, :host ::content .scrollable{
        max-height: 100vh;
        height: 100%;

        overflow: auto;
        -webkit-overflow-scrolling: touch;
      }

      :host .is-active{
        display: block;
      }
      :host .is-passive{
        display: none;
      }


      :host .viewport{
          overflow: hidden;
        position: relative;
      }

      :host .l-primary-sidebar{
        float: left;
      }

      :host .l-primary-content,
      :host  .l-secondary-content{
        position: relative;
      }

    </style>
    <div id="_layoutMain" class="flex flex--col">

        <!-- header -->
        <div id="_layoutHeader" class="viewport l-header hidden-md-down">
          <content id="headerContent" select="px-header"></content>
        </div>




        <div id="_layoutViewport" class="viewport viewport--full-height">
          <!-- primary-sidebar -->
          <div class="l-primary-sidebar">
            <px-drawer id="primarySidebar"
              type$="{{options.primarySidebar.type}}"
              side$="{{options.primarySidebar.side}}"
              theme$="{{options.primarySidebar.theme}}">
              <content id="primarySidebarContent" select=".primary-sidebar"></content>
            </px-drawer>
          </div>
          <div class="flex flex--row">

            <!-- Secondary Content -->
            <div class="l-secondary-content flex__item flex--col is-passive">
              <content id="secondaryContent" select=".secondary-content"></content>
            </div>

            <!-- Primary Content -->
            <div class="l-primary-content flex__item flex--col is-active">
              <content id="primaryContent" select=".primary-content"></content>
            </div>

            <!-- Any Content Views / Pages -->
            <div class="l-content">
              <content id="contentContent" select=".content"></content>
            </div>

          </div>

        </div>

        <!-- secondary-sidebar -->
        <div class="l-secondary-sidebar">
          <px-drawer id="secondarySidebar" side="right" theme="dark">
            <content id="secondarySidebarContent" select=".secondary-sidebar"></content>
          </px-drawer>
        </div>


        <div id="footer" class="viewport hidden-md-down">
          <content id="footerContent" select="px-footer"></content>
        </div>
    </div>
  </template>
  <script>
    Polymer({
      is: 'px-layout',
      properties: {
        //The layout type (full, progressive, splitview, offcanvas)
        type: {
          type: String,
          value: 'full'
        },
        navItems: {
          type: Array
        },
        options: {
          type: Object,
          observer: '_handleOptions',
          value: {
            primarySidebar:{
              theme: 'dark'
            }
          }
        },
        breakpoints: {
          type: Object,
          value: {
            xs: '(min-width: 330px)',
            sm: '(min-width: 480px)',
            md: '(min-width: 768px)',
            lg: '(min-width: 992px)',
            xl: '(min-width: 1200px)'
          }
        }
      },
      attached: function() {
        this.toggleClass('l-container', true, this.$._layoutViewport);
        this.toggleClass('l-container--' + this.type, true, this.$._layoutViewport);

        var hasNavbar = this.$$('.navbar');
        if(hasNavbar){
        }
        console.log(this.tagName, this.options);
      },
      toggle: function(name, options) {
        var el = this.$[name];
        if(el.toggle){
          el.toggle();
        }
        console.warn('toggle', name, el);
      },
      toggleContent: function(name){
        //toggle primary / secondary content is-active / is-passive
        console.log("toggle content");

      },
      _setElementOptions: function(options){
        var self = this;
        var key, value, o, el;

        // TODO: Beter way to set options on component;
        if(options){
          for(var k in options){
            console.log("find element", k, 'set =>', options[k]);
            el = self.$[k];
            value = options[k];
            //el[k] = value;
            console.log('setting', k,  options[k], value);
          }
        }
      },
      _handleOptions: function(newVal, oldVal){
        this._setElementOptions(this.options);
        console.log(this.tagName, 'options', newVal);
      }

    });
  </script>
</dom-module>
